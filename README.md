# í•œêµ­ì–´ ì±—ë´‡ ëª¨ë¸ë§

## ê°œìš”
> **ì•„ì´í  Project & Main Quest** <br/> 
> **í”„ë¡œì íŠ¸ ê¸°ê°„: 2024.06.21** <br/>

## â­ï¸ í”„ë¡œì íŠ¸ ì†Œê°œ
- í•œêµ­ì–´ ì±—ë´‡ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œêµ­ì–´ ì±—ë´‡ì„ ë§Œë“¤ì–´ë³´ëŠ” í”„ë¡œì íŠ¸í‹€ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

- `Transformer for ChatBot From Scratch`
  - íŠ¸ëœìŠ¤í¬ë¨¸ êµ¬ì¡°ë¥¼ í•™ìŠµí•˜ê³  ì§ì ‘ êµ¬í˜„í•˜ëŠ” ì‹œê°„ì„ ê°€ì¡ŒìŠµë‹ˆë‹¤.
  - [korean-chatbot-Transformer.ipynb](Ko-Chatbots-From-Scratch/korean-chatbot-Transformer.ipynb)
- `GPT for ChatBot From Scratch`
  - ì•ì„œ êµ¬í˜„í•œ Transformer êµ¬ì¡°ë¥¼ ìˆ˜ì •í•˜ì—¬ GPT êµ¬ì¡°ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
  - [korean-chatbot-GPT.ipynb](Ko-Chatbots-From-Scratch/korean-chatbot-GPT.ipynb)

### ë°ì´í„°ì…‹ ì¶œì²˜
- chatbot ë°ì´í„° ì¶œì²˜ëŠ” ì•„ë˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤
  ```text
  Youngsook Song.(2018). Chatbot_data_for_Korean v1.0)[Online].
  Available : https://github.com/songys/Chatbot_data (downloaded 2022. June. 29.)
  ```
## ì‚¬ìš©ìš©ë„
- [korean-chatbot-Transformer.ipynb](Ko-Chatbots-From-Scratch/korean-chatbot-Transformer.ipynb)
  - Transformerì— ëŒ€í•œ ìì„¸í•œ êµ¬ì¡°ë¥¼ ì½”ë“œë¥¼ í†µí•´ í™•ì¸í•´ë³´ê³  ì‹¶ë‹¤ë©´ ì´ ì½”ë“œë¥¼ í†µí•´ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  - ë˜í•œ, ì´ íŒŒì¼ì—ëŠ” custom modelì„ ì €ì¥í•˜ëŠ” ì½”ë“œê°€ ì¶”ê°€ë˜ì–´ ìˆìŠµë‹ˆë‹¤
  - learning rate, model êµ¬ì¡°ë¥¼ customize í–ˆì„ ë•Œ ì–´ë–»ê²Œ ëª¨ë¸ì„ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ”ì§€ ì°¸ê³ í•˜ê¸° ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤
- [korean-chatbot-GPT.ipynb](Ko-Chatbots-From-Scratch/korean-chatbot-GPT.ipynb)
  - ìœ„ transformer notebookì„ ë³´ê³  GPTë¥¼ ì´í•´í•˜ê³  ì‹¶ë‹¤ë©´ ì´ íŒŒì¼ì„ í†µí•´ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤

----
## ğŸ“š STACKS

### Environment
![Pycharm](https://img.shields.io/badge/PyCharm-000000.svg?&style=for-the-badge&logo=PyCharm&logoColor=white)
![Github](https://img.shields.io/badge/GitHub-181717?style=for-the-badge&logo=GitHub&logoColor=white)

### Development
![Python](https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=python&logoColor=white)
![keras](https://img.shields.io/badge/Keras-D00000?style=for-the-badge&logo=Keras&logoColor=white)
![Tensorflow](https://img.shields.io/badge/TensorFlow-FF6F00?style=for-the-badge&logo=tensorflow&logoColor=white)
![Pandas](https://img.shields.io/badge/Pandas-2C2D72?style=for-the-badge&logo=pandas&logoColor=white)
![Numpy](https://img.shields.io/badge/Numpy-777BB4?style=for-the-badge&logo=numpy&logoColor=white)
![scikit](https://img.shields.io/badge/scikit_learn-F7931E?style=for-the-badge&logo=scikit-learn&logoColor=white)

## ë³€ê²½ì‚¬í•­ (Transformer ì—ì„œ GPTë¡œ)
- ìì„¸í•œ ì½”ë“œëŠ” [korean-chatbot-GPT.ipynb](Ko-Chatbots-From-Scratch/korean-chatbot-GPT.ipynb) ì°¸ê³ 

### ì „ì²˜ë¦¬ ë‹¨ê³„
    - Unsupervised Pre-training
        - ëª¨ë¸ì´ ë‹¤ìŒ í† í°ì„ ì˜ˆì¸¡í•˜ë„ë¡ í•˜ë‚˜ì˜ ë¬¸ì¥ ë°ì´í„°ë¥¼ í•™ìŠµí•˜ëŠ” êµ¬ì¡°
        - ì§ˆë¬¸, ë‹µë³€ ë¬¸ì¥ì„ ì—°ê²°í•˜ì§€ ì•Šê³  í•™ìŠµì„ ìœ„í•´ row ë°©í–¥ìœ¼ë¡œ ë¶™ì—¬ì£¼ì—ˆë‹¤
        - ë‹µë³€ì—ì„œ ì¤‘ë³µ ë¬¸ì¥ë“¤ì´ ë§ì•˜ê¸°ì— ì´ 19436ê°œì˜ ë°ì´í„°ë¥¼ í•™ìŠµí•˜ì˜€ë‹¤
        - train dataì˜ í† í° ê¸¸ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ Pre-trainingì—ì„œì˜ max lengthëŠ” 40ìœ¼ë¡œ ì„¤ì •í•´ì¤¬ë‹¤
    - Supervised Fine-tuning
        - ì§ˆë¬¸ê³¼ ë‹µë³€ ë°ì´í„°ë¥¼ êµ¬ë¶„ì í† í°ê³¼ í•¨ê»˜ í•˜ë‚˜ì˜ ì‹œí€€ìŠ¤ë¡œ ê²°í•©
        - delimiter token ì„ ì¶”ê°€
        - Supervised Fine-tuning datasetì€ ê¸°ì¡´ pre-training ë°©ì‹ê³¼ ë°ì´í„°ì…‹ì´ ë‹¤ë¥´ê²Œ ë“¤ì–´ê°€ì•¼í•œë‹¤
        - [[start] ì§ˆë¬¸ [delimiter] ë‹µ [end]] êµ¬ì¡°ì´ë¯€ë¡œ ê¸¸ì´ë„ ì¢€ ë” ê¸¸ê²Œ ì„¤ì •í•´ì¤˜ì•¼í•œë‹¤
        - train dataì˜ í† í° ê¸¸ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ finetuningì—ì„œì˜ max lengthëŠ” 70ìœ¼ë¡œ ì„¤ì •í•´ì¤¬ë‹¤

### ëª¨ë¸ êµ¬í˜„ ë‹¨ê³„
    - GPTëŠ” ë””ì½”ë”ë§Œìœ¼ë¡œ êµ¬ì„±ëœ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ì´ë‹¤
    - Encoder-Decoder Attention ì œê±° :
        - GPTëŠ” ë””ì½”ë”ë§Œìœ¼ë¡œ êµ¬ì„±ë˜ê¸° ë•Œë¬¸ì— encoderì™€ ë¹„êµí•˜ëŠ” encoder-decoder Attention Layerê°€ í•„ìš”ê°€ ì—†ë‹¤.
        - ê¸°ì¡´ ì½”ë“œì—ì„œ ë‘ ë²ˆì§¸ ì„œë¸Œ ë ˆì´ì–´ë¥¼ ì œê±°í•œë‹¤
        ---------------------------------------------------------------------------------------
                attention2 = MultiHeadAttention(
                    d_model, num_heads, name="attention_2")(inputs={
                          'query': attention1,
                          'key': enc_outputs,
                          'value': enc_outputs,
                          'mask': padding_mask
                      })

                # ë§ˆìŠ¤í¬ë“œ ë©€í‹° í—¤ë“œ ì–´í…ì…˜ì˜ ê²°ê³¼ëŠ”
                # Dropoutê³¼ LayerNormalizationì´ë¼ëŠ” í›ˆë ¨ì„ ë•ëŠ” í…Œí¬ë‹‰ì„ ìˆ˜í–‰
                attention2 = tf.keras.layers.Dropout(rate=dropout)(attention2)
                attention2 = tf.keras.layers.LayerNormalization(
                  epsilon=1e-6)(attention2 + attention1)
       -----------------------------------------------------------------------------------------
    - ì¸ì½”ë” ì¶œë ¥ ì œê±° : encoder_outputs ì œê±°
    - ë§ˆìŠ¤í‚¹ ë°©ì‹ : padding mask ì œê±°, look_ahead_mask ë§Œ ì‚¬ìš©í•˜ë©´ë¨



íšŒê³  ë° ê²°ë¡ 
---
### íšŒê³ 
<details>
  <summary><b>Transformer êµ¬í˜„ íšŒê³ </b></summary>
  <div markdown="1">
    <li> ë°°ìš´ ì 
      <li>transformerì˜ êµ¬ì¡°ì— ëŒ€í•´ ì¢€ ë” ëª…í™•íˆ ì´í•´í•  ìˆ˜ ìˆì—ˆë‹¤ </li>
      <li>custom ëª¨ë¸ ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ë‹¤ </li>
      <li>ìˆ«ìë¥¼ ì œê±°í•˜ëŠ” ì „ì²˜ë¦¬ ì œê±°ë§Œìœ¼ë¡œë„ ëŒ€ë‹µì´ í™•ì—°íˆ ë‹¬ë¼ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤ </li>
      <li>underfitting ìƒí™©ì„ ìƒê°í•´ì„œ epochì„ ë†’ì˜€ë”ë‹ˆ ì„±ëŠ¥ì´ í–¥ìƒë˜ì—ˆë‹¤</li>
    </li>
    <li>ì•„ì‰¬ìš´ ì 
      <li>í”„ë¡œì íŠ¸ì—ì„œ í•œê¸€ í† í°ì„ ì˜ ë§Œë“¤ì§€ ëª»í•´ì„œ ì•„ì‰¬ì› ë‹¤</li>
      <li>í† í°í™”ë¥¼ ì˜ í•˜ì§€ ëª»í•´ì„œ ë„ì–´ì“°ê¸°ì— ë”°ë¼ì„œ ë‹µë³€ì´ ë‹¬ë¼ì§„ë‹¤</li>
    </li>
    <li>ëŠë‚€ ì 
      <li>ì–´ë ¤ìš´ ê°œë…ì´ë¼ë„ ë…¸ë ¥í•˜ë©´ ì´í•´í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ëŠê¼ˆë‹¤</li>
      <li>ì±—ë´‡ë„ ê²°êµ­ ì–´ë–¤ ë°ì´í„°ë¥¼ í•™ìŠµí•˜ëƒì— ë”°ë¼ ëŒ€ë‹µì´ ë‹¬ë¼ì§„ë‹¤</li>
    </li>
    <li>ì–´ë ¤ì› ë˜ ì 
      <li>transformerì˜ êµ¬ì¡°ë¥¼ ì´í•´í•˜ëŠ”ë° ì–´ë ¤ì› ë‹¤</li>
      <li>custom ëª¨ë¸ ì €ì¥í•˜ëŠ” ë° config ì„¤ì •í•˜ëŠ” ê²ƒì´ ì–´ë ¤ì› ë‹¤</li>
    </li>
  </div>
</details>
<details>
  <summary><b>GPT êµ¬í˜„í•˜ê¸° íšŒê³ </b></summary>
  <div markdown="1">
    <li> ë°°ìš´ ì 
      <li>ë…¼ë¬¸ì„ ì½ê³  ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ GPT ëª¨ë¸ì„ ì§ì ‘ êµ¬í˜„í•´ë³¼ ìˆ˜ ìˆì—ˆë‹¤</li>
    </li>
    <li>ì•„ì‰¬ìš´ ì 
      <li>Unsupervised pre-training ë‹¨ê³„ì—ì„œ ì¢€ ë” ë‹¤ì–‘í•œ ë¬¸ì¥ë“¤ì„ ì‹¤í—˜í•´ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ì•˜ë‹¤</li>
      <li>ë°ì´í„°ì…‹ì´ ì ì–´ì„œ pretrain weightë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ê²Œ ì˜¤íˆë ¤ ì„±ëŠ¥ì´ ì¢‹ì§€ ì•Šì•˜ë‹¤</li>
    </li>
    <li>ëŠë‚€ ì 
      <li>transformerë³´ë‹¤ë„ ì¼ë°˜í™” ì„±ëŠ¥ì´ ì˜ ë˜ëŠ” ê²ƒ ê°™ì•˜ë‹¤</li>
    </li>
    <li>ì–´ë ¤ì› ë˜ ì 
      <li>ì§ì ‘ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ ëª¨ë¸ shapeë¥¼ ë§ì¶”ëŠ” ê²ƒì´ ìƒê°ë³´ë‹¤ ê¹Œë‹¤ë¡œì› ë‹¤</li>
      <li>ê¸°ì¡´ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ëŠ” ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë§ì´ ë‚¬ë‹¤</li>
    </li>
  </div>
</details>

### ê²°ë¡ 
- ì§ì ‘ Transformerì™€ GPTë¥¼ êµ¬í˜„í•˜ë©´ì„œ ìì„¸í•œ êµ¬ì¡°ì— ëŒ€í•´ì„œ ë°°ìš¸ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤
- ì´ë²ˆ ê²½í—˜ì„ í†µí•´ Transformer, GPT êµ¬ì¡°ì— ëŒ€í•´ ì˜ ì•Œ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤

## ë””ë ‰í† ë¦¬ êµ¬ì¡°
```bash
â”œâ”€â”€ README.md
â”œâ”€â”€ data : ë°ì´í„° ì…‹ì„ ì—¬ê¸°ì— ë‹¤ìš´ ë°›ì•„ì„œ ë„£ì–´ì¤ë‹ˆë‹¤
â”œâ”€â”€ korean-chatbot-Transformer.ipynb
â””â”€â”€ korean-chatbot-GPT.ipynb
```

